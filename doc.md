# Discord Bot 用户命令使用说明

## 全局命令

### `/发送通知`
在当前频道发送一个格式化的通知消息。
- 必填参数：
  - `标题`: 通知的标题(最多256字)
  - `内容`: 通知的具体内容(最多4096字)
- 可选参数：
  - `图片`: 要显示的图片URL
  - `颜色`: 通知的颜色(蓝色/绿色/紫色/粉色/青色)
- 冷却时间：60秒

### `/私聊通知`
通过机器人向指定用户发送私聊通知。
- 必填参数：
  - `目标用户`: 要发送私聊通知的用户
  - `标题`: 通知的标题
  - `内容`: 通知的具体内容
- 可选参数：
  - `图片`: 要显示的图片URL
  - `颜色`: 通知的颜色
- 冷却时间：60秒
- 注意：不能向自己或机器人发送私聊通知

### `/自助管理`
管理你自己创建的帖子。
- 子命令：
  - `/自助管理 删除`: 删除你的帖子
  - `/自助管理 锁定并关闭`: 锁定并关闭你的帖子
    - 可选参数：`理由`: 锁定原因
  - `/自助管理 标注信息`: 标注或取消标注一条消息
    - 必填参数：
      - `消息链接`: 要标注的消息链接
      - `操作`: 选择标注或取消标注
  - `/自助管理 清理不活跃`: 清理帖子中的不活跃用户
    - 可选参数：
      - `阈值`: 目标人数阈值(默认950, 800-1000)
- 冷却时间：10秒
- 注意：只能在你创建的论坛帖子中使用

### `/申请上庭`
对处罚进行上诉或申请处罚。
- 子命令：
  - `/申请上庭 禁言`: 申请禁言处罚
    - 必填参数：
      - `目标`: 要处罚的用户
      - `理由`: 处罚理由
      - `时长`: 建议的禁言时长
    - 可选参数：
      - `图片链接`: 相关证据的图片链接
  - `/申请上庭 永封`: 申请永久封禁
    - 必填参数：
      - `目标`: 要处罚的用户
      - `理由`: 处罚理由
    - 可选参数：
      - `保留消息`: 是否保留用户的消息
      - `图片链接`: 相关证据的图片链接
  - `/申请上庭 撤销`: 撤销处罚申请
    - 必填参数：
      - `消息链接`: 要撤销的议事区议事消息的链接
- 冷却时间：3600秒
- 注意：所有申请都会进入议事流程

## 系统管理员命令

### `/暂停邀请`
暂停当前服务器的邀请功能。
- 必填参数：
  - `操作`: 选择闭关锁国或开闸放水
  - `理由`: 执行此操作的原因
- 权限要求：管理员
- 冷却时间：10秒

### `/同步指令`
检查并同步当前服务器的Discord指令。
- 无参数
- 权限要求：管理员
- 注意：此命令会自动同步所有新增、修改和删除的指令

### `/快速禁言`
创建一个持续5分钟的快速禁言1小时投票。
- 必填参数：
  - `目标`: 处罚的目标用户
- 权限要求：管理员
- 冷却时间：30秒

### `/撤销处罚`
撤销指定的处罚记录。
- 必填参数：
  - `处罚id`: 要撤销的处罚ID
  - `原因`: 撤销原因
- 权限要求：管理员
- 冷却时间：5秒

### `/同步永封`
同步所有服务器的永封列表。
- 无参数
- 权限要求：管理员
- 注意：此命令会自动同步所有服务器的永封记录

### `/系统状态`
查看当前系统运行状态。
- 无参数
- 权限要求：管理员或版主
- 冷却时间：3秒
- 显示内容：网络延迟、服务器数量、WebSocket状态、队列状态等

### `/提交议事`
将当前帖子提交到议事区进行投票准备。
- 无参数
- 权限要求：管理员
- 冷却时间：10秒
- 注意：只能在论坛帖子中使用

### `/批量添加身份组`
为所有没有指定身份组的成员添加目标身份组。
- 无参数
- 权限要求：管理员
- 冷却时间：30秒
- 注意：此命令留作调试，现已停用

## 版主命令

### `/查询记录`
查询数据库中的处罚和流程记录。
- 必填参数：
  - `类型`: 要查询的记录类型(处罚记录/流程记录)
- 可选参数：
  - `用户`: 筛选特定用户的记录
- 权限要求：管理员或版主
- 冷却时间：3秒

### `/管理帖子`
管理论坛帖子的各项功能。
- 必填参数：
  - `帖子链接`: 要管理的帖子链接
  - `操作`: 处理方针（锁定/解锁/归档/开启/论坛标注/取消论坛标注）
  - `理由`: 处理原因
- 权限要求：版主或管理员
- 冷却时间：10秒

### `/管理频道`
修改频道的各项设置。
- 必填参数：
  - `频道`: 要管理的频道
- 可选参数：
  - `名称`: 新的频道名称(1-100字)
  - `主题`: 频道主题/描述(最多1024字)
  - `限速`: 发言限速时间(0-21600秒)
  - `nsfw`: 是否为年龄限制频道
  - `自动归档`: 帖子自动归档时间(1小时/1天/3天/1周)
- 权限要求：版主或管理员
- 冷却时间：10秒

### `/添加标签`
添加新的论坛标签。
- 必填参数：
  - `论坛`: 要添加标签的论坛频道
  - `名称`: 标签名称(1-20字)
- 可选参数：
  - `仅限版主`: 是否仅限版主使用此标签
- 权限要求：版主或管理员
- 冷却时间：10秒

### `/处罚`
对用户执行处罚。
- 子命令：
  - `/处罚 永封`: 永久封禁用户
    - 必填参数：
      - `用户`: 要处罚的用户
      - `原因`: 处罚原因
      - `保留消息`: 是否保留用户的消息
  - `/处罚 禁言`: 临时禁言用户
    - 必填参数：
      - `用户`: 要处罚的用户
      - `时长`: 禁言时长(例如: 3d4h5m)
      - `原因`: 处罚原因
    - 可选参数：
      - `警告`: 同时添加警告(例如: 30d)
- 权限要求：
  - 永封：管理员
  - 禁言：版主或管理员
- 冷却时间：5秒

### `/议员快速审核`
快速审核议员申请帖。
- 无参数
- 权限要求：版主或管理员
- 冷却时间：10秒
- 注意：只能在议员申请论坛中使用

### `/一键锁定关贴`
锁定并归档当前论坛帖子。
- 必填参数：
  - `理由`: 处理原因
- 权限要求：版主或管理员
- 冷却时间：10秒
- 注意：只能在论坛帖子中使用

## 长时任务命令

### `/清理活跃贴`
清理不活跃的子区。
- 必填参数：
  - `阈值`: 活跃子区数量阈值(500-1000)
- 权限要求：管理员
- 冷却时间：10秒

### `/清理子区不活跃用户`
清理子区中的不活跃用户。
- 子命令：
  - `/清理子区不活跃用户 当前`: 清理当前子区的不活跃用户
    - 可选参数：
      - `阈值`: 目标人数阈值(默认950, 800-1000)
  - `/清理子区不活跃用户 全部`: 清理所有超过阈值的子区
    - 可选参数：
      - `阈值`: 目标人数阈值(默认980, 900-1000)
- 权限要求：管理员
- 冷却时间：10秒

### `/更新分析报告`
分析论坛子区活跃度统计。
- 无参数
- 权限要求：管理员
- 冷却时间：10秒
- 注意：分析结果会发送到日志频道

### `/清理频道`
清理指定频道中的消息。
- 必填参数：
  - `结束消息`: 清理到哪条消息
- 可选参数：
  - `起始消息`: 从哪条消息开始清理
- 权限要求：管理员
- 冷却时间：10秒
- 注意：此命令会分批处理消息，可能需要较长时间

## 定时任务说明

系统会自动执行以下定时任务：

### 数据库相关任务
1. **数据库备份**
   - 执行时间：每天早上6点
   - 功能：自动备份数据库内容，确保数据安全

2. **定时器重载**
   - 执行时间：每天凌晨3点
   - 功能：重新加载所有流程和处罚的定时任务，确保系统稳定运行

### 子区管理任务
1. **活跃度分析**
   - 执行时间：每小时整点
   - 功能：分析论坛子区的活跃度，生成统计报告，刷新置顶贴状态
   - 注意：仅在服务器启用了自动分析功能时执行

2. **自动清理**
   - 执行时间：每小时整点（与活跃度分析同时进行）
   - 功能：清理超过人数阈值的不活跃子区
   - 默认阈值：960人
   - 注意：仅在服务器启用了自动清理功能时执行

### 其他自动任务
1. **流程到期处理**
   - 功能：自动处理已到期的议事和上诉流程
   - 触发：根据流程的到期时间自动执行

2. **处罚到期处理**
   - 功能：自动处理已到期的处罚（禁言/警告，取较长）
   - 触发：根据处罚的到期时间自动执行（超24天的使用中间计时器延期处理）

3. **投票状态更新**
   - 功能：自动处理投票的公开和结束
   - 触发：根据投票的公开时间和结束时间自动执行

注意：所有定时任务都会在系统日志中记录执行情况，如遇到错误也会自动记录。管理员可以通过日志追踪任务执行状态。

## 注意事项
1. 所有命令都有冷却时间限制，请注意使用频率。
2. 图片URL需要是有效的图片链接(即图片为http或https头，格式为png/jpg/gif/webp)。
3. 管理命令可能需要特定的频道权限（一般而言，频道权限对应的是当前频道的管理消息权限）。
4. 命令的响应默认只有你自己可见，但涉及删除锁定处罚等命令时，bot会发送通知到管理频道。
5. 一切处罚系统均在所有服务器生效，请谨慎使用。
6. 如遇到错误，机器人会给出具体的错误提示。