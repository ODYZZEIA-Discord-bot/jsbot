# 事件处理

## 用户加入事件

- 功能: 当用户加入服务器时, 自动检查并执行未过期的处罚
- 处理内容.
  - 检查用户是否有未过期的禁言或警告
  - 自动同步执行处罚 (永封类型除外)
  - 更新处罚的同步状态

## 交互事件

处理用户与机器人的各类交互. 处理内容有:

### 按钮交互

- 优先级控制: 上庭/投票/支持类按钮使用队列管理
- 上诉类按钮优先级最高 (4), 其他为中等 (3)

### 模态框提交

统一延迟回复

### 斜杠命令

命令优先级为:

- 管理级任务 (5)
- 管理员任务 (4)
- 用户任务 (3)
- 耗时后台任务 (2)
- 默认任务 (1)

## WebSocket 状态监控

监控并维护与 Discord 的网络连接. 处理内容有:

### 网络监控

- 记录重连和断线情况
- 每分钟检查延迟变化
- 记录显著的延迟波动 (>100ms)

### API 限制监控

- 监控API使用频率
- 自动处理速率限制
- 记录受限情况和恢复时间
